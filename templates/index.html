{% extends "base.html" %}

{% block variables %}
<script>
    var papers = {{ papers | tojson }};
    var tags = {{ tags | tojson }};
    var words = {{ words | tojson }};
    var all_top_words = {{ all_top_words | tojson }};
    var words_desc = {{ words_desc | tojson }};
    var gvars = {{ gvars | tojson }};

    /*
    JS code here handles pagination. I really don't super love this approach,
    if anyone can think of a cleaner / shorter way please let me know.
    */
    var move_page = function (int_offset) {
        var queryParams = new URLSearchParams(window.location.search);
        queryParams.set("page_number", Math.max(1, parseInt(gvars.page_number) + int_offset));
        window.location.href = '/?' + queryParams.toString();
    }
</script>


{% endblock %}

{% block content %}

{% if not user %}
<div id="log-fun-warn">(hi! just btw you have to be logged in to be able to add/delete/curate tags for papers and get
    recommendations)</div>
{% endif %}

<div id="controls">
    <div class="col">
        <form class="col">
            {% if user and all_top_words %}
            <label for="tags">tags: </label>
            {# Render all the words, so the user knows what they can search in this instance #}
            <div id="all-word-list"></div>
            {# <input name="tags" type="text" id="tags_field" value="{{ gvars.tags }}"> #}
            {% endif %}
        </form>
        <div class="row">
            {{ rank_description }}
        </div>
    </div>
</div>

{% if user and tags %}
<div id="tagwrap" class="row">
</div>
{% endif %}

{% if user and words %}
<div id="wordwrap" style="display:none;">
</div>
{% endif %}

<!-- main content showing all the papers as a list -->
<div id="wrap" class="col">
</div>

<!-- links to previous and next pages -->
<div id="pagination" class="row">
    <a id="link-prev-page" onclick='move_page(-1);'>prev</a>
    <span>current page: {{ gvars.page_number }} </span>
    <a id="link-next-page" onclick='move_page(1);'>next</a>
</div>
{% endblock %}

{% block elements %}
<script src="{{ url_for('static', filename='paper_list.js') }}" type="text/babel"></script>
<script src="{{ url_for('static', filename='word_list.js') }}" type="text/babel"></script>
<script src="{{ url_for('static', filename='all_word_list.js') }}" type="text/babel"></script>
{% endblock %}